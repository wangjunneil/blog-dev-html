<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- pwa meta begin --><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#000"><meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="format-detection" content="telephone=no"><meta name="msapplication-tap-highlight" content="no"> <!-- IOS不会读取manifest中的icon，用此配置进行适配 --><link rel="apple-touch-icon" href="assets/icons/icon-96x96.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/icon-180x180.png"><link rel="apple-touch-icon" sizes="167x167" href="/assets/icons/icon-167x167.png"> <!-- ios修复splash黑屏 --><link href="/assets/img/icons/apple_splash_1125.png" sizes="1125x2436" rel="apple-touch-startup-image" /><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"> <!-- pwa meta end --><title>由浅入深 python selenium 的使用</title><meta name="description" content=""><meta name="keywords" content="selenium,自动化,chromedriver,爬虫"><link rel="stylesheet" href="/assets/fonts/fonts.css"><link rel="icon" href="/assets/favicon.ico"><link rel="stylesheet" href="/assets/core.css"><link rel="stylesheet" href="/assets/syntax.css"><link rel="canonical" href="/2023/05/python-selenium/"><link rel="alternate" type="application/atom+xml" title="The Jun Wong's blog" href="/feed.xml" /></head><body> <!-- 全局页面loading --><div class="loading"><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div><!-- search --><div class="searchform"> <a href="javascript:void(0);" class="searchicon"></a> <input type="text" id="keyword" autocomplete="off"/> <a href="javascript:void(0);" class="clear"></a><ul class="suggest"></ul></div><script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> <script src="/assets/js/main.js"></script><nav class="header-nav"> <a class="page-link" href="/">HOME</a> / <a class="page-link" href="/categories/">CATEGORY</a> / <a class="page-link" href="/feed.xml">FEED</a> / <a class="page-link" href="/about/">ABOUT</a></nav><main><article> <!-- 目录导航，在nav,js中进行渲染 --><div class="w-catalog"></div><div class="w-catalog-btn">目录</div><div class="center"><h1>由浅入深 python selenium 的使用</h1><time>2023-05-13</time></div><div class="divider"></div><ul id="markdown-toc"><li><a href="#1-使用前提" id="markdown-toc-1-使用前提">1. 使用前提</a><ul><li><a href="#11-依赖库的安装" id="markdown-toc-11-依赖库的安装">1.1. 依赖库的安装</a></li><li><a href="#12-驱动执行文件" id="markdown-toc-12-驱动执行文件">1.2. 驱动执行文件</a></li></ul></li><li><a href="#2-使用方式" id="markdown-toc-2-使用方式">2. 使用方式</a><ul><li><a href="#21-快速开始" id="markdown-toc-21-快速开始">2.1. 快速开始</a></li><li><a href="#22-浏览器参数" id="markdown-toc-22-浏览器参数">2.2. 浏览器参数</a></li></ul></li></ul><h1 id="1-使用前提">1. 使用前提</h1><h2 id="11-依赖库的安装">1.1. 依赖库的安装</h2><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip3 <span class="nb">install </span>selenium <span class="c"># selenium 目前使用4.x.x的版本</span>
</code></pre></div></div><h2 id="12-驱动执行文件">1.2. 驱动执行文件</h2><p>打开 Chrome 浏览器，输入 <code class="language-plaintext highlighter-rouge">chrome://version</code> 查看 Chromium 版本号，如：<code class="language-plaintext highlighter-rouge">Chromium: 112.0.5615.138</code>，再去 <a href="https://chromedriver.storage.googleapis.com/index.html">chrome driver</a> 找到对应版本的驱动程序，下载保存。</p><blockquote><p>这里浏览器不局限于 Google Chrome，只要是任何 Chromium 内核构建的都可以，作者使用的是 brave 浏览器</p></blockquote><h1 id="2-使用方式">2. 使用方式</h1><h2 id="21-快速开始">2.1. 快速开始</h2><p>下面的程序作用是自动打开浏览器进入百度搜索，输入关键字后点击搜索按钮，完成自动执行，浏览器不关闭。</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.service</span> <span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>

<span class="c1"># 浏览器程序与驱动路径
</span><span class="n">BROWSER_LOCATION</span> <span class="o">=</span> <span class="s">'C:\Program Files\Google\Chrome\Application\chrome.exe'</span>
<span class="n">DRIVER_LOCATION</span> <span class="o">=</span> <span class="s">'D:\SeleniumDriver\chromedriver.exe'</span>

<span class="c1"># 初始化
</span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
<span class="n">options</span><span class="p">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s">"detach"</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--ignore-certificate-errors'</span><span class="p">)</span>
<span class="n">options</span><span class="p">.</span><span class="n">binary_location</span> <span class="o">=</span> <span class="n">BROWSER_LOCATION</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">Service</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="n">DRIVER_LOCATION</span><span class="p">),</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

<span class="c1"># 打开网址
</span><span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'https://www.baidu.com'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">maximize_window</span><span class="p">()</span>

<span class="c1"># 解释 javascript 脚本
# driver.execute_script('window.location.href="https://www.google.com"')
</span>
<span class="n">search_box</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="n">NAME</span><span class="p">,</span> <span class="s">'wd'</span><span class="p">)</span>
<span class="n">search_box</span><span class="p">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">'chatgpt使用'</span><span class="p">)</span>
<span class="n">search_button</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span> <span class="s">'su'</span><span class="p">)</span>
<span class="n">search_button</span><span class="p">.</span><span class="n">click</span><span class="p">()</span>

<span class="c1"># 关闭浏览器
</span><span class="n">driver</span><span class="p">.</span><span class="n">quit</span><span class="p">()</span>
</code></pre></div></div><h2 id="22-浏览器参数">2.2. 浏览器参数</h2><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">ChromeOptions</span><span class="p">()</span>

<span class="c1"># 设置useragent
</span><span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--user-agent=user_agent'</span><span class="p">)</span>

<span class="c1"># 忽略浏览器证书错误
</span><span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--ignore-certificate-errors"</span><span class="p">)</span>

<span class="c1"># 无界面模式，对于自动化测试和爬虫等任务非常有用，可提高运行效率，并减少资源消耗，因为不需要渲染和显示页面
</span><span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--headless'</span><span class="p">)</span>

<span class="c1"># 开发者模式
</span><span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--auto-open-devtools-for-tabs"</span><span class="p">)</span> 

<span class="c1"># 设置代理
</span><span class="n">options</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--proxy-server=http://ip:port'</span><span class="p">)</span>

<span class="c1"># 浏览器的命令开关选项
# enable-logging，在启动时不要启用日志记录功能，这可以减少浏览器在控制台输出日志的数量
</span><span class="n">options</span><span class="p">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s">'excludeSwitches'</span><span class="p">,</span> <span class="p">[</span><span class="s">'enable-logging'</span><span class="p">])</span>

 <span class="c1"># 手机模式
</span><span class="n">options</span><span class="p">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s">"mobileEmulation"</span><span class="p">,</span> <span class="p">{</span><span class="s">"deviceName"</span><span class="p">:</span> <span class="s">"iPhone 12 Pro"</span><span class="p">})</span>
</code></pre></div></div><blockquote><p>更多的选项参看，<a href="https://peter.sh/experiments/chromium-command-line-switches/#disable-touch-drag-drop">https://peter.sh/experiments/chromium-command-line-switches/#disable-touch-drag-drop</a></p></blockquote><div class="divider"></div><blockquote id='by-nc-nd'><div> 版权所有，本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">知识共享署名-非商业性使用 3.0 未本地化版本许可协议</a>进行许可。转载请注明出处：<a href="https://www.wangjun.dev//2023/05/python-selenium/" akt="">https://www.wangjun.dev//2023/05/python-selenium/</a></div></blockquote><div class="divider"></div></article><div class="page-navigation"> <a class="next" href="/2023/06/telegram-bot/" title="NEXT: python telegram bot 开发">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="/" title="Back to Homepage">Home</a> <span> &middot; </span> <a class="prev" href="/2022/12/pet-shop-dapp/" title="PREV: 去中心化的宠物领养 DApp 应用">&gt;&gt;</a></div><!-- 书签处理 --> <script type="text/javascript" src="/assets/js/zepto.min.js"></script> <script type="text/javascript" src="/assets/js/nav.js"></script></main><!-- service worker check update bar --><div id="notification">A new version of this app is available. Click <a id="reload">here</a> to update.</div></body></html>